date: "12/12/2021"
header-includes:
  - \usepackage{amsmath}
  - \usepackage{mathtools}
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Second step

The goal of this step is the estimation of the main characteristics of the quantitative variables. After the transformation of some of quantitatives attributes in cathegorical variables, our dataset contains four continuous variables: *MEDV*, *TAX*, *NOX* and *CRIME*. 

We have to consider our data come from an homogeneous population. As we have seen in the previous step, exploratory analysis has suggested that we can divide data in different groups. Hence, in order to check this assumption we will do inference over data estimating the mean vector, covariance matrix and correlation matrix. Therefore, we will be able to state each group formed belongs to a different population separately.

The dataset is located in the scenario where there are more observations than variables (i.e. $n > p$, where $n$ is the number of observations which the dataset contains and $p$ the number of attributes). Thus, we will use the following expressions to compute the different estimations for a dataset with $n$ observations and $p$ variables:

 - Estimation of $\mu$ as $E[\bar{x}]=\mu$, where $X = ({x}_{1},..., {x}_{p})^{T}$ and $\bar{x}$ is calculated as:

$$
\bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_{i.} =
\begin{pmatrix}
 \bar{x}_{1}\\
 \bar{x}_{2} \\
 \vdots\\
 \bar{x}_{p}
\end{pmatrix}$$

 - Estimation of $\sum$ as $E[S] = \sum$, where $S$ is the covariance matrix of $x = ({x}_{1},..., {x}_{p})^{T}$ and it is obtained as following:

$$
 S = \frac{1}{n-1}\sum_{i=1}^{n}(x_{i.}-\bar{x})(x_{i.}-\bar{x}) =
\begin{pmatrix}
 {s}_{1}^{2}&{s}_{12}^{2}&...&{s}_{1p}^{2}\\
 {s}_{21}^{2}&{s}_{2}^{2}&...&{s}_{2p}^{2}\\
 \vdots & \ddots & \ddots & \vdots \\
 {s}_{n1}^{2}&{s}_{n2}^{2}&...&{s}_{p}^{2}
\end{pmatrix}$$

where ${s}_{p}^{2}$ is the sample variance of $x_j$ and ${s}_{jk}^{2}$ is the sample covariance bewteen $x_j$ and $x_k$ with $j\neq	k$.

 - Estimation of correlation matrix of $X = ({x}_{1},..., {x}_{p})^{T}$ through covariance matrix as following:
 
$$
 R = 
\begin{pmatrix}
 1&{r}_{12}&...&{r}_{1p}\\
 {r}_{21}&1&...&{r}_{2p}\\
 \vdots & \ddots & \ddots & \vdots \\
 {r}_{n1}&{r}_{n2}&...&1
\end{pmatrix}$$

knowing that ${r}_{jk}$ with $j\neq	k$ is computed with expression ${r}_{jk} = \frac{{s}_{jk}}{{s}_{j}{s}_{k}}$ which is the sample correlation coefficient between $x_j$ and $x_k$.


In view of the conclusions which we have obtained in analysis step, we will compute the previous expressions. We have identified a group formed by the cualitative variable *LSTAT.CAT* and the four quantitative attributes left, as we consider any quantitative variable could be different for both of the two classes. Therefore, we will be able to see if certain attribute is related with other.


```{r}
if (!require("corrplot")) install.packages("corrplot")
library("corrplot")
if (!require("dplyr")) install.packages("dpylr")
library(dplyr)
#####################################################################

X <- read.csv("Dataset.csv")

# Select quantitative variables
X_quan = X %>% select(TAX, MEDV, CRIM, NOX)

#SAMPLE MEAN, COVARIANCE AND CORRELATION FOR QUANTITATIVE VARIABLES
m_quan <- colMeans(X_quan)
S_quan <- cov(X_quan)
R_quan <- cor(X_quan)

# LSTAT - QUATITATIVE VARIABLES
# LSTAT: Two possibles categories 

X_LSTAT_verylow <- X_quan[X$LSTAT <= 25,]
X_LSTAT_low <- X_quan[X$LSTAT >= 25,]

#SAMPLE MEAN, COVARIANCE AND CORRELATION MATRIX FOR LSTAT <= VERY LOW
m_LSTAT_verylow <- colMeans(X_LSTAT_verylow)
S_LSTAT_verylow <- cov(X_LSTAT_verylow)
R_LSTAT_verylow <- cor(X_LSTAT_verylow)

#SAMPLE MEAN, COVARIANCE AND CORRELATION MATRIX FOR LSTAT <= LOW
m_LSTAT_low <- colMeans(X_LSTAT_low)
S_LSTAT_low <- cov(X_LSTAT_low)
R_LSTAT_low <- cor(X_LSTAT_low)

```
## Interpretation of mean vector

```{r}
m_quan
m_LSTAT_low
m_LSTAT_verylow
```

We can see the mean of the observations in which class *LSTAT* is 0 is lower than those observations which belong to the other class to the variable *MEDV*. It means that an upper percentage of 


